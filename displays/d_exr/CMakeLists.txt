PROJECT(D_EXR)

SET(D_EXR_SRCS d_exr.cpp ../util/dspyhlpr.c)

IF(AQSIS_OPENEXR_FOUND)
	ADD_DEFINITIONS(-DD_EXR_EXPORTS)

	INCLUDE(${DDMANAGER_SOURCE_DIR}/export.cmake)
	INCLUDE_DIRECTORIES(${AQSIS_OPENEXR_INCLUDE_DIR} ../util)

	ADD_LIBRARY(d_exr SHARED ${D_EXR_SRCS} ${INFORES_SRCS})
	# Generate the display declaration for the aqsisrc file.
	GET_TARGET_PROPERTY(LOCOFD_EXR d_exr LOCATION)
	GET_FILENAME_COMPONENT(DISPLAYLIB ${LOCOFD_EXR} NAME)

	SET(LINKLIBS ${AQSIS_OPENEXR_LIBRARIES} ${AQSIS_ZLIB_LIBRARIES})

	TARGET_LINK_LIBRARIES(d_exr ${LINKLIBS})

	INSTALL(TARGETS d_exr 
		RUNTIME DESTINATION ${DISPLAYSDIR}
		LIBRARY DESTINATION ${DISPLAYSDIR}
		ARCHIVE DESTINATION ${LIBDIR})
ENDIF(AQSIS_OPENEXR_FOUND)
